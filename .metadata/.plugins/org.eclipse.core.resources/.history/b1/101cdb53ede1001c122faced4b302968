package connectingFolksWeb;

import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.Scanner;

public class CreatePost
{

	public void Option(String userName) 
	{
        Scanner input=new Scanner(System.in);
        System.out.println("..............Choose One Option.............");
        System.out.println(" 1.Post  \n 2.View own post \n 3.View tagged post \n 4.Exit ");
        int ch=input.nextInt();
        switch (ch)
        {
		case 1: {
		    	createAPost(userName);
			break;
		}
		case 2:
			viewOwnPost(userName);
			break;
		case 3:
			viewTaggedPost(userName);
			break;
		
		
		case 4:
		{
			UserIdHome obj=new UserIdHome();
 	       obj.userAccount();
 	    	 
			break;
		}

	}

}

	private void viewTaggedPost(String userName)
	{
	       System.out.println();
	       System.out.println(); 
	       System.out.println("  [       -----> Tagged Posts <-------  ]");
	         System.out.println();
	 		LinkedHashMap<Integer, PostDetails> receivedPost=new LogInPage().database.get(userName).receivedPost;
	    
	          boolean checkReceived=receivedPost.isEmpty();
	          
	          if(checkReceived==true) 
	          {
	         	   System.out.println();
	         	   System.out.println("   [ *Tagged posts are empty ]   ");
	                System.out.println("--------------------------------------------------------------");
	         	   System.out.println();
	    
	         	   Option(userName);
	          }
	                   
	          Iterator<Integer> itr=receivedPost.keySet().iterator();
	          while(itr.hasNext())
	          {
	         	 int key=itr.next();
	         	 System.out.println(key);
	         	 PostDetails robej=receivedPost.get(key);
	         	 System.out.println("******************");
	         	 System.out.println("[ Message ID ]  ::  "+robej.postId);
	         	 System.out.println("[    from    ]  ::  "+robej.userName);
	         	 System.out.println("[   Subject  ]  ::  "+robej.subject);
	         	 System.out.println("[   Message  ]  ::  "+robej.message);
	         	 
	          }
	          System.out.println("Do you want to comment");
	         	
	          Option(userName);
	
	}

	private void viewOwnPost(String userName)
	{
        LinkedHashMap<Integer, PostDetails> ownPost=new LogInPage().database.get(userName).ownPost;

        System.out.println();
        System.out.println();
        System.out.println("           [--------> Created posts <----------]     ");
        System.out.println();
        
        boolean checkPostBox=ownPost.isEmpty();
                  if(checkPostBox==true) 
         {
        	   System.out.println();
        	   System.out.println("    [ You won't create any post yet ]   ");
System.out.println("---------------------------------------------------------------------------");
        	   System.out.println();
        	   Option(userName);
         }
           
          
         Iterator<Integer> itr=ownPost.keySet().iterator();
         while(itr.hasNext())
         {
        	 int key=itr.next();
        	 PostDetails object=ownPost.get(userName);
        	 System.out.println("******************");
        	 System.out.println("[ Message ID ]  ::  "+object.postId);
        	 System.out.println("[    From    ]  ::  "+object.userName);
        	 System.out.println("[     To     ]  ::  "+object.shareTo);
        	 System.out.println("[   Subject  ]  ::  "+object.subject);
        	 System.out.println("[   Message  ]  ::  "+object.message);
        	/* System.out.println("[   Comments  ]  ::  "+);
        	 System.out.println("[   Liked by  ]  ::  "+object.message);
            */ 
         
         }
         
         
         Option(userName);

	}

	private void createAPost(String userName)
	{
		LinkedHashMap<String,String> comments=new LinkedHashMap<>();
	     LinkedHashMap<String,String> likes=new LinkedHashMap<>();
	 	
		System.out.println();
		System.out.println("........Share your Knowledge Section.......");
            Scanner input=new Scanner(System.in);

            System.out.println("From : "+userName);
            System.out.println("TO : ");
            String shareTo=input.nextLine();
            
            
                boolean checkToaddress=LogInPage.database.containsKey(shareTo);
            
                if(checkToaddress==false) 
                {
               	 System.out.println("        [   *This username [ "+shareTo+" ] cannot found  ]     ");
                    Option(userName);      
                }
            
            System.out.println("Subject : ");
            String subject=input.nextLine();
            System.out.println("Message : ");
            String message =input.nextLine();
            int postID=(int)(Math.random()*100+100);
            System.out.println("Comment To "+shareTo + " :");
            String com=input.nextLine();
            comments.put(userName, com);
            PostDetails details=new PostDetails(userName,shareTo,subject,message,postID,comments,likes);

            boolean msgSendOrNot=SendorNot(shareTo,details,postID);
            if(msgSendOrNot) {
             new LogInPage();
			LinkedHashMap<Integer, PostDetails> toOwnPost=LogInPage.database.get(userName).ownPost;
			toOwnPost.put(postID, details);
             System.out.println("     [  Message Added mailbox  ]   ");
            }
            Option(userName);
	}

	private boolean SendorNot(String shareTo,PostDetails details,int postID) {
        new LogInPage();
		LinkedHashMap<Integer, PostDetails> toReceivedPost=LogInPage.database.get(shareTo).receivedPost;
        toReceivedPost.put(postID, details);
        System.out.println();
        System.out.println("        [  Message Succesfully Send to  "+details+"       ]");
        System.out.println();
        return true;
	}

	}
